{% extends 'landing_base.html' %}
{% load static %}
{% load custom_filters %} 

{% block title %}Home{% endblock %}

{% block content %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

<div class="offcanvas-menu-overlay"></div>
<div class="offcanvas-menu-wrapper">
    <div class="offcanvas__option">
        <div class="offcanvas__links">
            <a href="#">Sign in</a>
            <a href="#">FAQs</a>
        </div>
        <div class="offcanvas_top_hover">
            <span>Usd <i class="arrow_carrot-down"></i></span>
            <ul>
                <li>USD</li>
                <li>EUR</li>
                <li>USD</li>
            </ul>
        </div>
    </div>
    <div class="offcanvas_nav_option">
        <a href="#" class="search-switch"><img src="/static/frontend/img/icon/search.png" alt=""></a>
        <a href="#"><img src="/static/frontend/img/icon/heart.png" alt=""></a>
        <a href="#"><img src="/static/frontend/img/icon/cart.png" alt=""> <span>0</span></a>
        <div class="price">$0.00</div>
    </div>
    <div id="mobile-menu-wrap"></div>
    <div class="offcanvas__text">
        <p>Free shipping, 30-day return or refund guarantee.</p>
    </div>
</div>
<section class="hero">
    <div class="hero__slider owl-carousel">
        {% for banner in banners %}
        <div class="hero__items set-bg" data-setbg="{{ banner.photo.url }}">
            <div class="container">
                <div class="row">
                    <div class="col-xl-5 col-lg-7 col-md-8">
                        <div class="hero__text" data-aos="fade-right" data-aos-duration="1000" data-aos-delay="200">
                           <h6 style="font-size: 30px; font-weight: 700;">
    {{ banner.title }}
</h6>

                            <h2 style="font-size: 16px; line-height: 1.4; color:rgb(85, 81, 81)">{{ banner.description }}</h2>
                        {% if banner.product %}
    <a href="{% url 'product_detail' banner.product.id %}" class="primary-btn">
        Shop now <span class="arrow_right"></span>
    </a>
{% else %}
    <a href="{% url 'shop_all' %}" class="primary-btn">
        Shop now <span class="arrow_right"></span>
    </a>
{% endif %}

                            <div class="hero__social">
                                <a href="#"><i class="fa fa-facebook"></i></a>
                                <a href="#"><i class="fa fa-twitter"></i></a>
                                <a href="#"><i class="fa fa-pinterest"></i></a>
                                <a href="#"><i class="fa fa-instagram"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
<style>
    /* Your original CSS styles for responsiveness, animations, etc. (Keep them) */
    @media only screen and (min-width: 1200px) {
    .container {
        max-width: 1090px;
    }
}
.heart-outlined {
    color: #ffffff;
    text-shadow: 
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000,
        1px 1px 0 #000;
}

.hero__items,
.hero__items .set-bg {
    border-radius: 12px;
    overflow: hidden;
}

/* Product Images - Featured & Regular */
.product__item__pic,
.product__item__pic.set-bg,
.featured-card-image {
    border-radius: 10px;
    overflow: hidden;
}

/* Hot Deal Product Images */
.categories_hot_deal img {
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
}

/* Instagram Gallery Images */
.instagram_pic_item,
.instagram_pic_item.set-bg {
    border-radius: 8px;
    overflow: hidden;
}

/* Blog Post Images */
.blog_item_pic,
.blog_item_pic.set-bg {
    border-radius: 10px;
    overflow: hidden;
}

/* Banner Section Images */
.banner__item,
.banner_item_pic,
.banner_item_pic.set-bg {
    border-radius: 12px;
    overflow: hidden;
}



/* Product Cards - Complete Styling */
.product__item {
    border-radius: 12px;
    overflow: hidden;
    transition: all 0.3s ease;
    background: #fff;
}

.featured-card {
    border-radius: 12px;
    overflow: hidden;
}

/* Blog Items */
.blog__item {
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
}

.blog__item:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 20px rgba(0,0,0,0.15);
}

/* Instagram Section Enhancements */
.instagram__pic {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
}

.instagram_pic_item {
    position: relative;
    padding-bottom: 100%;
    transition: all 0.3s ease;
}

.instagram_pic_item:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 25px rgba(0,0,0,0.2);
}

/* Hot Deal Section Polish */
.categories_hot_deal {
    position: relative;
    padding: 20px;
    text-align: center;
}

.hot_deal_sticker {
    border-radius: 8px;
}

/* Responsive Adjustments */
@media (max-width: 768px) {
    .product__item__pic,
    .featured-card-image,
    .blog_item_pic {
        border-radius: 8px;
    }
    
    .hero__items {
        border-radius: 8px;
    }
    
    .instagram__pic {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
    }
}

@media (max-width: 480px) {
    .instagram__pic {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
    }
    
    .product__item__pic,
    .featured-card-image {
        border-radius: 6px;
    }
}

/* Additional Polish - Smooth Transitions */
.set-bg {
    transition: transform 0.3s ease;
}

.product__item:hover .product__item__pic,
.featured-card:hover .featured-card-image {
    transform: scale(1.02);
}

/* Ensure labels stay within rounded corners */
.label,
.featured-card-label {
    border-radius: 4px;
    margin: 8px;
}



/* Animation styles */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeInLeft {
    from {
        opacity: 0;
        transform: translateX(-30px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes fadeInRight {
    from {
        opacity: 0;
        transform: translateX(30px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes pulse {
    0% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.05);
    }
    100% {
        transform: scale(1);
    }
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% {
        transform: translateY(0);
    }
    40% {
        transform: translateY(-10px);
    }
    60% {
        transform: translateY(-5px);
    }
}

/* Product hover animations (Keep them) */
.product__item {
    transition: all 0.3s ease;
    overflow: hidden;
}

.product__item:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 30px rgba(0,0,0,0.1);
}

.product_item_pic {
    transition: all 0.5s ease;
    position: relative;
}

.product_item:hover .productitem_pic {
    transform: scale(1.05);
}

.product__hover {
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.3s ease;
}

.product_item:hover .product_hover {
    opacity: 1;
    transform: translateY(0);
}

.product_item_text {
    transition: all 0.3s ease;
}

.product_item:hover .productitem_text {
    background-color: #f9f9f9;
}

.add-cart {
    transition: all 0.3s ease;
}

.add-cart:hover {
    background-color: #000;
    color: #fff;
}

/* Banner animations */
.banner__item {
    overflow: hidden;
    position: relative;
}

.banner_item_pic {
    transition: all 0.5s ease;
}

.banner_item:hover .banneritem_pic {
    transform: scale(1.1);
}

.banner_item_text {
    transition: all 0.3s ease;
}

.banner_item:hover .banneritem_text {
    background-color: rgba(255,255,255,0.9);
}

/* Hero section animations */
.hero__text h6 {
    animation: fadeInUp 1s ease forwards;
}

.hero__text h2 {
    animation: fadeInUp 1s ease 0.3s forwards;
    opacity: 0;
}

.hero__text .primary-btn {
    animation: fadeInUp 1s ease 0.6s forwards;
    opacity: 0;
}

.hero__social {
    animation: fadeInUp 1s ease 0.9s forwards;
    opacity: 0;
}

/* Read more link animation */
.read-more-link {
    position: relative;
    transition: all 0.3s ease;
}

.read-more-link:after {
    content: '';
    position: absolute;
    width: 0;
    height: 2px;
    bottom: -5px;
    left: 0;
    background-color: #0a3d62;
    transition: width 0.3s ease;
}

.read-more-link:hover:after {
    width: 100%;
}

/* Wishlist heart animation */
.wishlist-btn i {
    transition: all 0.3s ease;
}

.wishlist-btn:hover i {
    animation: pulse 0.5s ease;
}

/* Countdown animation */
.cd-item {
    animation: bounce 2s infinite;
}

.cd-item:nth-child(2) {
    animation-delay: 0.2s;
}

.cd-item:nth-child(3) {
    animation-delay: 0.4s;
}

.cd-item:nth-child(4) {
    animation-delay: 0.6s;
}

/* NEW FEATURE PRODUCT CARD STYLES */
.featured-card {
    display: flex;
    flex-direction: column;
    margin-bottom: 25px;
    border: 1px solid #e9ecef;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
}

.featured-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
}

.featured-card-image {
    height: 200px; /* Fixed height for image area */
    background-size: cover;
    background-position: center;
    position: relative;
    overflow: hidden;
}

.featured-card-body {
    padding: 15px;
    text-align: center;
    flex-grow: 1;
}

.featured-card-body h6 {
    font-weight: 700;
    font-size: 1.1rem;
    margin-bottom: 5px;
    line-height: 1.3;
}

.featured-card-price h5 {
    color: #e53637;
    font-weight: 700;
    margin: 5px 0 10px;
}

.featured-card-actions {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 10px;
}

.featured-card-actions .btn {
    padding: 8px 15px;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 600;
}

.featured-card-actions .primary-btn {
    background: #341f1f;
    color: white;
    border: none;
}
.featured-card-actions .primary-btn:hover {
    background: #c02d2e;
}

.featured-card-actions .secondary-btn {
    background: white;
    color: #2c3e50;
    border: 1px solid #e9ecef;
}
.featured-card-actions .secondary-btn:hover {
    background: #f1f1f1;
}

.featured-card-label {
    position: absolute;
    top: 10px;
    left: 10px;
    background: #000;
    color: white;
    padding: 3px 8px;
    font-size: 0.75rem;
    font-weight: 600;
    border-radius: 3px;
    z-index: 10;
}
.featured-card-label.sale {
    background: #ff0000;
}
/* For Feature Products and Our Products images */
.featured-card-image, 
.product__item__pic {
    position: relative; /* Essential for absolute children */
}

/* Style to make the image-link cover the entire image area */
.image-link {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 2; /* Lower than action icons, higher than the image */
}

/* Ensure the action icons are clickable above the image-link */
.product__hover {
    z-index: 3; /* Must be higher than image-link's z-index: 2 */
    /* Adjust position/opacity transitions as needed, but z-index is key */
}

/* For the Featured Card Wishlist icon, which is positioned differently */
.featured-card .product__hover {
    z-index: 10; /* Make sure it's on top */
    /* You already have 'position: absolute;' and coordinates on the inline style */
}

/* Make sure the image link doesn't block the label */
.featured-card-label {
    z-index: 11;
}

.swiper-button-next,
.swiper-button-prev {
  color: #fff !important;
  background: none;
  width: 30px;
  height: 30px;
  transition: all 0.3s ease;
}

.swiper-button-next::after,
.swiper-button-prev::after {
  font-size: 22px;
  font-weight: 600;
}

.swiper-button-next:hover,
.swiper-button-prev:hover {
  color: #f8f9fa !important; /* lighter white on hover */
  transform: scale(1.1);
}

/* Optional: reposition slightly */
.swiper-button-next {
  right: 10px;
}
.swiper-button-prev {
  left: 10px;
}

/* Featured Products Carousel Styles */
.featured-swiper {
  padding: 20px 0;
}

.featured-swiper .swiper-slide {
  height: auto;
  display: flex;
  align-items: stretch;
}

.featured-swiper .product__item {
  margin: 0 10px;
  width: calc(100% - 20px);
}

@media (max-width: 768px) {
  .featured-swiper .product__item {
    margin: 0 5px;
    width: calc(100% - 10px);
  }
}

</style>

<section class="categories-section py-5" data-aos="fade-up">
  <div class="container-fluid px-5">
    <div class="row mb-4">
      <div class="col-lg-12 text-center">
        <h3 class="section-title mb-1" data-aos="fade-up">
          <b>Shop By Category</b>
        </h3>
        <p class="text-muted" style="font-size: 15px;">Explore our top categories and find what suits you best.</p>
      </div>
    </div>

    <div class="row g-4 justify-content-center">
      {% for category in categories %}
      <div class="col-xl-3 col-lg-4 col-md-6">
        <div class="category-card position-relative overflow-hidden rounded-4 shadow-sm">
          <a href="{% url 'category_products' category.id %}" class="text-decoration-none text-white d-block h-100">
            {% if category.photo %}
              <img src="{{ category.photo.url }}" alt="{{ category.title }}" class="category-img">
            {% else %}
              <img src="{% static 'images/default-category.png' %}" alt="{{ category.title }}" class="category-img">
            {% endif %}
            <div class="category-overlay d-flex flex-column justify-content-end p-3">
              <h4 class="fw-bold mb-1">{{ category.title }}</h4>
              {% if category.summary %}
                <p class="small mb-0">{{ category.summary|truncatechars:70 }}</p>
              {% endif %}
            </div>
          </a>
        </div>
      </div>
      {% empty %}
      <div class="col-12 text-center">
        <p class="text-muted">No categories available.</p>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- ====== Category Section Styling ====== -->
<style>
.categories-section {
  background-color: #f8f9fa;
}

.section-title {
  font-size: 2rem;
  font-weight: 700;
  letter-spacing: 0.5px;
  text-transform: uppercase;
}

.category-card {
  height: 260px;
  position: relative;
  border-radius: 16px;
  transition: all 0.4s ease;
}

.category-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
  border-radius: 16px;
}

.category-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.7), rgba(0,0,0,0));
  color: #fff;
  border-radius: 0 0 16px 16px;
  padding: 20px;
  transition: all 0.4s ease;
}

.category-card:hover .category-img {
  transform: scale(1.07);
}

.category-card:hover .category-overlay {
  background: linear-gradient(to top, rgba(0, 0, 0, 0.85), rgba(0,0,0,0.15));
}

.category-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
}

/* ✅ Wider look on large screens */
@media (min-width: 1400px) {
  .col-xl-3 {
    flex: 0 0 28%;
    max-width: 28%;
  }
}

/* ✅ On medium and small screens */
@media (max-width: 991px) {
  .category-card {
    height: 220px;
  }
}
@media (max-width: 767px) {
  .category-card {
    height: 200px;
  }
}
</style>


<!-- Featured Products Carousel Section -->
<section class="product spad mt-5">
    <div class="container">
        <!-- Section Title -->
        <div class="row mb-4">
            <div class="col-lg-12">
                <h3 class="section-title mb-1" data-aos="fade-up">
                    <b>Feature Products</b>
                </h3>
            </div>
        </div>

        <!-- Featured Products Swiper -->
        <div class="featured-swiper">
            <div class="swiper myFeaturedSwiper">
                <div class="swiper-wrapper">
                    {% for product in featured_products %}
                    <div class="swiper-slide">
                        <div class="product__item {% if product.is_sale %}sale{% endif %}" style="position: relative; overflow: hidden;">
                            <!-- Image Container -->
                            <div class="product__item__pic set-bg"
                                 data-setbg="{% if product.photo %}{{ product.photo.url }}{% else %}{% static 'frontend/img/product/placeholder.jpg' %}{% endif %}">
                                {% if product.is_new %}
                                    <span class="label">New</span>
                                {% elif product.is_sale %}
                                    <span class="label">Sale</span>
                                {% endif %}

                                <!-- Hover Icons (top-right corner) -->
                                <ul class="product__hover" style="top: 10px; right: 10px;">
                                    <li>
                                        {% if user.is_authenticated %}
                                        <a href="#" class="wishlist-btn" data-product-id="{{ product.pk }}">
                                            {% if product.pk in wishlisted_ids %}
                                                <i class="fa fa-heart" style="color: #ff0000; font-size: 18px;"></i>
                                            {% else %}
                                                <i class="fa fa-heart heart-outlined" style="font-size: 18px; color: #fff;"></i>
                                            {% endif %}
                                        </a>
                                        {% else %}
                                        <a href="{% url 'login' %}">
                                            <i class="fa fa-heart heart-outlined" style="font-size: 18px; color: #fff;"></i>
                                        </a>
                                        {% endif %}
                                    </li>
                                </ul>

                                <!-- Clickable overlay for image only -->
                                <a href="{% url 'product_detail' product.pk %}" 
                                   class="image-link" 
                                   style="position: absolute; inset: 0; z-index: 1;"></a>
                            </div>

                            <!-- Product Details -->
                            <div class="product__item__text" style="position: relative; z-index: 2; background: #fff; padding: 10px 0; text-align: center;">
                                <h5 style="margin-bottom: 5px; color: #222; font-weight: 500;">{{ product.title }}</h5>
                                <h5 style="color: #000;">₹{{ product.price|floatformat:2 }}</h5>
                            </div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="swiper-slide">
                        <p class="text-center">No featured products available.</p>
                    </div>
                    {% endfor %}
                </div>
                <!-- Swiper navigation -->
                <div class="swiper-button-next featured-next"></div>
                <div class="swiper-button-prev featured-prev"></div>
            </div>
        </div>
    </div>
</section>

<!-- Product Section -->
<section class="product spad">
    <div class="container">
        <!-- Heading -->
        <div class="row mb-4">
            <div class="col-lg-12">
                <h3 class="section-title mb-1"><b>Our Products</b></h3>
            </div>
        </div>

        <div class="row product__filter position-relative">
            {% for product in products|slice:":8" %}
<div class="col-lg-3 col-md-6 col-sm-6 mix
            {% if product.is_new %}new-arrivals{% elif product.is_sale %}hot-sales{% endif %}"
     data-aos="fade-up" 
     data-aos-duration="800" 
     data-aos-delay="{% widthratio forloop.counter0 1 100 %}">
                <div class="product__item {% if product.is_sale %}sale{% endif %}">

                    <!-- Image container -->
                    <div class="product__item__pic set-bg" 
                         data-setbg="{% if product.photo %}{{ product.photo.url }}{% else %}{% static 'frontend/img/product/placeholder.jpg' %}{% endif %}">
                        {% if product.is_new %}<span class="label">New</span>{% elif product.is_sale %}<span class="label">Sale</span>{% endif %}

                        <!-- Hover icons -->
                        <ul class="product__hover">
                            <li>
                                {% if user.is_authenticated %}
                                <a href="#" class="wishlist-btn" data-product-id="{{ product.pk }}">
                                    {% if product.pk in wishlisted_ids %}
                                        <i class="fa fa-heart" style="color: #ff0000; font-size: 18px;"></i>
                                    {% else %}
                                        <i class="fa fa-heart heart-outlined" style="font-size: 18px;"></i>
                                    {% endif %}
                                </a>
                                {% else %}
                                <a href="{% url 'login' %}">
                                    <i class="fa fa-heart heart-outlined" style="font-size: 18px;"></i>
                                </a>
                                {% endif %}
                            </li>
                          
                        </ul>

                        <!-- Clickable overlay for image -->
                        <a href="{% url 'product_detail' product.pk %}" class="image-link"></a>
                    </div>

                    <!-- Product info below image -->
                    <div class="product__item__text">
                        <h6>{{ product.title }}</h6>
                        <a href="{% url 'product_detail' product.pk %}" class="add-cart">
                            {% if user.is_authenticated %}+ Add To Cart{% else %}Login to Add{% endif %}
                        </a>

                        <div class="rating">
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                        </div>

                        <h5>₹{{ product.price|floatformat:2 }}</h5>

                        <div class="product__color__select">
                            {% if product.color_data %}
                                {% for color in product.color_data %}
                                    <label style="background: {{ color.code }};"
                                           for="pc-{{ product.id }}-{{ forloop.counter }}">
                                        <input type="radio" id="pc-{{ product.id }}-{{ forloop.counter }}" 
                                               name="color-{{ product.id }}" value="{{ color.name }}" hidden>
                                    </label>
                                {% endfor %}
                            {% else %}
                                <label for="pc-{{ product.id }}-1">
                                    <input type="radio" id="pc-{{ product.id }}-1" hidden>
                                </label>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}

            {% if total_products_count > 8 %}
          <div class="col-12 d-flex justify-content-end mt-2">
  <a href="{% url 'shop_all' %}" 
     class="read-more-link" 
     style="color:#333; font-weight:500; text-decoration:none; transition:all 0.3s ease;"
     onmouseout="this.style.color='#333'; this.style.textDecoration='none';">
     Read More
  </a>
</div>

            {% endif %}
        </div>
    </div>
</section>
<section class="categories spad">
  <div class="container">
    <div class="swiper myHotSwiper">
      <div class="swiper-wrapper">
        {% for product in hot_discounted_products %}
        <div class="swiper-slide">
          <div class="row align-items-center">
            <!-- Left Text -->
            <div class="col-lg-3" data-aos="fade-right" data-aos-duration="800">
              <div class="categories__text">
                <h2>
                  {{ product.category.name|default:"Clothings" }} Hot <br />
                  <span>{{ product.title|truncatechars:18 }}</span><br />
                  Accessories
                </h2>
              </div>
            </div>

            <!-- Product Image -->
            <div class="col-lg-4" data-aos="fade-up" data-aos-duration="800" data-aos-delay="200">
              <div class="categories_hot_deal">
                <img src="{{ product.photo.url }}" alt="{{ product.title }}">
                {% if product.discount %}
                <div class="hot_deal_sticker">
                  <span>Sale Of</span>
                  <h5>{{ product.discount }}% OFF</h5>
                </div>
                {% endif %}
              </div>
            </div>

            <!-- Product Info -->
            <div class="col-lg-4 offset-lg-1" data-aos="fade-left" data-aos-duration="800" data-aos-delay="400">
              <div class="categories_deal_countdown">
                <span>Deal Of The Week</span>
                <h2>{{ product.title }}</h2>
                <p>{{ product.summary|truncatechars:60 }}</p>
                <div class="categories_dealcountdown_timer" id="countdown-{{ forloop.counter }}" data-end-date="{{ product.deal_end_date|date:'c' }}">
                  <div class="cd-item"><span>0</span><p>Days</p></div>
                  <div class="cd-item"><span>0</span><p>Hours</p></div>
                  <div class="cd-item"><span>0</span><p>Minutes</p></div>
                  <div class="cd-item"><span>0</span><p>Seconds</p></div>
                </div>
                <a href="{% url 'product_detail' product.id %}" class="primary-btn">Shop now</a>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>

      <!-- Swiper navigation -->
      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>
    </div>
  </div>
</section>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<script>
  var swiper = new Swiper(".myHotSwiper", {
    slidesPerView: 1,
    spaceBetween: 30,
    loop: true,
    autoplay: {
      delay: 4000,
      disableOnInteraction: false,
    },
    navigation: {
      nextEl: ".swiper-button-next",
      prevEl: ".swiper-button-prev",
    },
  });

  // Featured Products Swiper
  var featuredSwiper = new Swiper(".myFeaturedSwiper", {
    slidesPerView: 4,
    spaceBetween: 30,
    loop: true,
    autoplay: {
      delay: 3000,
      disableOnInteraction: false,
    },
    navigation: {
      nextEl: ".featured-next",
      prevEl: ".featured-prev",
    },
    breakpoints: {
      320: {
        slidesPerView: 1,
        spaceBetween: 10
      },
      768: {
        slidesPerView: 2,
        spaceBetween: 20
      },
      1024: {
        slidesPerView: 3,
        spaceBetween: 25
      },
      1200: {
        slidesPerView: 4,
        spaceBetween: 30
      }
    }
  });
</script>

<div class="search-model">
    <div class="h-100 d-flex align-items-center justify-content-center">
        <div class="search-close-switch">+</div>
        <form class="search-model-form">
            <input type="text" id="search-input" placeholder="Search here.....">
        </form>
    </div>
</div>
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
// Initialize AOS (Animate On Scroll)
AOS.init({
    duration: 800,
    easing: 'ease-in-out',
    once: true, 
    mirror: false
});

$(document).ready(function() {
    // AJAX Wishlist Toggle (Keep this)
    $('.wishlist-btn').on('click', function(e) {
        e.preventDefault();
        var btn = $(this);
        var productId = btn.data('product-id');
        var csrftoken = '{{ csrf_token }}';

        $.ajax({
            url: '/toggle-wishlist/' + productId + '/',
            type: 'POST',
            data: {
                'csrfmiddlewaretoken': csrftoken
            },
            dataType: 'json',
            success: function(response) {
                if (response.status === 'ok') {
                    var heartIcon = btn.find('i');
                    var isAdded = response.is_added;

                    // Update Feature Card Icon
                    if (isAdded) {
                        heartIcon.removeClass('heart-outlined').css({'color': '#ff0000', 'text-shadow': 'none'});
                    } else {
                        // Check parent class for correct style removal
                        if(btn.closest('.featured-card').length) {
                             heartIcon.addClass('heart-outlined').css({'color': '#fff', 'text-shadow': 'none'});
                        } else {
                             heartIcon.addClass('heart-outlined').css('color', '');
                        }
                    }

                    // Animation for both product types
                    heartIcon.css('transform', 'scale(1.3)');
                    setTimeout(function() {
                        heartIcon.css('transform', 'scale(1)');
                    }, 300);

                    // Update badge
                    updateWishlistBadge(response.wishlist_count);
                }
            },
            error: function(xhr) {
                console.log('Error:', xhr.responseText);
                alert('Something went wrong. Please try again.');
            }
        });
    });

    // Wishlist Badge Logic (Keep this)
    function updateWishlistBadge(count) {
        var badge = $('.wishlist-count-badge');
        if (count > 0) {
            if (badge.length > 0) {
                badge.text(count).show();
            } else {
                var heartLink = $('a[href*="wishlist"]').first();
                heartLink.css('position', 'relative');
                heartLink.append('<span class="badge bg-danger rounded-circle wishlist-count-badge" style="position: absolute; top: -5px; right: -5px; font-size: 10px; min-width: 18px; height: 18px; padding: 2px 5px; line-height: 14px;">' + count + '</span>');
            }
        } else {
            badge.hide();
        }
    }

    // Dynamic Countdown Timer
    function updateCountdown(endDate, timerElement) {
        const end = new Date(endDate).getTime();
        const now = new Date().getTime();
        const distance = end - now;

        if (distance < 0) {
            // Deal expired
            timerElement.html('<div class="cd-item"><span>0</span><p>Days</p></div><div class="cd-item"><span>0</span><p>Hours</p></div><div class="cd-item"><span>0</span><p>Minutes</p></div><div class="cd-item"><span>0</span><p>Seconds</p></div><div style="text-align: center; color: red; font-weight: bold;">Deal Expired!</div>');
            return;
        }

        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        timerElement.find('.cd-item:nth-child(1) span').text(days);
        timerElement.find('.cd-item:nth-child(2) span').text(hours);
        timerElement.find('.cd-item:nth-child(3) span').text(minutes);
        timerElement.find('.cd-item:nth-child(4) span').text(seconds);
    }

    // Initialize countdown for each product
    $('.categories_dealcountdown_timer').each(function() {
        const endDate = $(this).data('end-date');
        if (endDate) {
            updateCountdown(endDate, $(this));
            // Update every second
            setInterval(function() {
                updateCountdown(endDate, $(this));
            }.bind(this), 1000);
        }
    });
});
</script>

{% endblock %}