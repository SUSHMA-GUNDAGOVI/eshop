{% extends 'admin_base.html' %}

{% block title %}Site Settings{% endblock %}

{% block content %}
<div class="container-fluid">

    <!-- Page Heading -->
    <div class="d-flex align-items-center justify-content-between mb-3">
        <h1 class="h3 text-gray-800">Site Settings</h1>
    </div>

    <!-- Settings Form -->
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Edit Settings</h6>
        </div>
        <div class="card-body">

            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}

                <!-- Short Description -->
                <div class="form-group">
                    <label for="id_short_des">Short Description <span class="text-danger">*</span></label>
                    <textarea class="form-control" id="id_short_des" name="short_des">{{ settings.short_des|default:'' }}</textarea>
                </div>

                <!-- Description -->
                <div class="form-group mt-2">
                    <label for="id_description">Description <span class="text-danger">*</span></label>
                    <textarea class="form-control" id="id_description" name="description">{{ settings.description|default:'' }}</textarea>
                </div>

                <!-- Logo -->
                <div class="form-group mt-2">
                    <label for="id_logo">Logo <span class="text-danger">*</span></label>
                    <input type="file" class="form-control" id="id_logo" name="logo">
                    {% if settings.logo %}
                        <img src="{{ settings.logo.url }}" alt="Logo" class="img-thumbnail mt-2" style="max-height:100px;">
                    {% endif %}
                </div>

                <!-- Photo -->
                <div class="form-group mt-2">
                    <label for="id_photo">Photo <span class="text-danger">*</span></label>
                    <input type="file" class="form-control" id="id_photo" name="photo">
                    {% if settings.photo %}
                        <img src="{{ settings.photo.url }}" alt="Photo" class="img-thumbnail mt-2" style="max-height:100px;">
                    {% endif %}
                </div>

                <!-- Address -->
                <div class="form-group mt-2">
                    <label for="id_address">Address <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" id="id_address" name="address"
                           value="{{ settings.address|default:'' }}" required>
                </div>

                <!-- Email -->
                <div class="form-group mt-2">
                    <label for="id_email">Email <span class="text-danger">*</span></label>
                    <input type="email" class="form-control" id="id_email" name="email"
                           value="{{ settings.email|default:'' }}" required>
                </div>

                <!-- Phone -->
                <div class="form-group mt-2">
                    <label for="id_phone">Phone <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" id="id_phone" name="phone"
                           value="{{ settings.phone|default:'' }}" required>
                </div>

                <button type="submit" class="btn btn-success mt-3">ðŸ’¾ Update Settings</button>
            </form>
        </div>
    </div>

    <!-- Toastify CSS & JS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    {% if success_message %}
    <script>
        (function () {
            var text = "{{ success_message|escapejs }}";
            if (window.Toastify) {
                Toastify({
                    text: text,
                    duration: 2000,
                    close: true,
                    gravity: "top",
                    position: "right",
                    backgroundColor: "#4CAF50",
                    stopOnFocus: true
                }).showToast();
            }
            // Remove ?success=1 from URL
            if (window.history.replaceState) {
                const url = new URL(window.location);
                url.searchParams.delete("success");
                window.history.replaceState({}, document.title, url.pathname);
            }
        })();
    </script>
    {% endif %}

</div>
{% endblock %}
